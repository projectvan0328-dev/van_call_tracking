<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì „í™” ì—°ê²° ì¤‘...</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Malgun Gothic', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    .message {
      text-align: center;
      color: white;
      padding: 40px;
      border-radius: 20px;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
    }
    .message p {
      font-size: 18px;
      margin: 0;
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    #callLink {
      display: none;
    }
  </style>
</head>
<body>
  <div class="message">
    <div class="spinner"></div>
    <p id="statusText">ğŸ“ ì „í™” ì—°ê²° ì¤‘...</p>
  </div>
  
  <!-- ìˆ¨ê²¨ì§„ ì „í™” ë§í¬ -->
  <a id="callLink" href="tel:"></a>
  
  <script>
    // ============================================
    // ğŸ“Œ ì „í™”ë²ˆí˜¸ ëª©ë¡
    // ============================================
    var PHONES = {
      'busan_uro_manager': { number: '010-3407-5133', name: 'ë¶€ì‚°ì—¬ì„±ë¹„ë‡¨ì˜í•™ê³¼ì˜ì› ì‹¤ì¥' },
      'busan_uro_clinic':  { number: '051-714-5210', name: 'ë¶€ì‚°ì—¬ì„±ë¹„ë‡¨ì˜í•™ê³¼ì˜ì› ì›ë‚´' },
      'hiu_manager': { number: '010-3307-5133', name: 'í•˜ì´ìœ ì™¸ê³¼ì„±í˜•ì™¸ê³¼ ì‹¤ì¥' },
      'hiu_clinic':  { number: '051-714-5133', name: 'í•˜ì´ìœ ì™¸ê³¼ì„±í˜•ì™¸ê³¼ ì›ë‚´' },
      'yoursk_manager': { number: '010-3053-3201', name: 'ë‹¹ì‹ ì˜í”¼ë¶€ê³¼ì˜ì› ì‹¤ì¥' },
      'yoursk_clinic':  { number: '051-924-1201', name: 'ë‹¹ì‹ ì˜í”¼ë¶€ê³¼ì˜ì› ì›ë‚´' },
      'zero_suwon':   { number: '031-235-3737', name: 'ì œë¡œí´ë¦¬ë‹‰ ìˆ˜ì›ì ' },
      'zero_incheon': { number: '032-435-3337', name: 'ì œë¡œí´ë¦¬ë‹‰ ì¸ì²œì ' },
      'zero_sinsa':   { number: '02-3447-1377', name: 'ì œë¡œí´ë¦¬ë‹‰ ì‹ ì‚¬ì ' }
    };

    // ============================================
    // ğŸ“Œ Google Apps Script URL (ì„¤ì • í›„ ì—¬ê¸°ì— ë¶™ì—¬ë„£ê¸°)
    // ============================================
    var SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyBFiHep0m1W8elHAL6bIgbUVa0anZAbqg_mL_ehkRD2PCXGOtOtPfoRTNu3jugcBWZ/exec';

    // ============================================
    // URL íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°
    // ============================================
    function getParam(name) {
      var url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
      var results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    // ============================================
    // ë©”ì¸ ì‹¤í–‰
    // ============================================
    var source = getParam('source') || 'direct';
    var phoneKey = getParam('phone') || 'unknown';
    var phoneInfo = PHONES[phoneKey] || null;

    if (phoneInfo && phoneInfo.number) {
      // ì¶”ì  ë°ì´í„°
      var trackingData = {
        timestamp: new Date().toISOString(),
        source: source,
        phoneKey: phoneKey,
        phoneName: phoneInfo.name,
        phoneNumber: phoneInfo.number,
        userAgent: navigator.userAgent,
        isMobile: /iPhone|iPad|iPod|Android/i.test(navigator.userAgent),
        screenWidth: window.screen.width,
        screenHeight: window.screen.height,
        referrer: document.referrer || 'direct'
      };

      // Google Sheetsì— ê¸°ë¡
      if (SCRIPT_URL !== 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
        try {
          var img = new Image();
          img.src = SCRIPT_URL + '?data=' + encodeURIComponent(JSON.stringify(trackingData));
        } catch(e) {}
      }

      // ì „í™”ë²ˆí˜¸ì—ì„œ í•˜ì´í”ˆ ì œê±°
      var cleanNumber = phoneInfo.number.replace(/-/g, '');
      var telUrl = 'tel:' + cleanNumber;
      
      // ë°©ë²• 1: a íƒœê·¸ í´ë¦­ ë°©ì‹ (ë” í˜¸í™˜ì„± ì¢‹ìŒ)
      var callLink = document.getElementById('callLink');
      callLink.href = telUrl;
      
      setTimeout(function() {
        callLink.click();
      }, 300);
      
      // ë°©ë²• 2: ë°±ì—… - 1ì´ˆ í›„ì—ë„ ì•ˆ ë˜ë©´ ì§ì ‘ ì´ë™
      setTimeout(function() {
        window.location.href = telUrl;
      }, 1000);
      
    } else {
      document.getElementById('statusText').textContent = 'âŒ ì˜ëª»ëœ ì „í™”ë²ˆí˜¸ ì½”ë“œì…ë‹ˆë‹¤: ' + phoneKey;
    }
  </script>
</body>
</html>
